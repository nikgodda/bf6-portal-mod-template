# BF6 Portal Mod Template

This is the official starter template for creating Battlefield 6 Portal Mods using TypeScript.

It provides:

-   clean project structure
-   ready `main.ts` and base `AGameMode` class
-   SDK typings (`SDK/mod` and `SDK/modlib`)
-   automatic merging into `__SCRIPT.ts`
-   automatic string generation into `__STRINGS.json`
-   integration with the `bf6-portal-mod-framework` build system

Use this template to build any structured BF6 Portal mod using classes, folders, and TypeScript modules ‚Äî the framework turns it into one final script.

---

# üß± Project Structure

```
my-mod/
‚îÇ   package.json
‚îÇ   tsconfig.json
‚îÇ   __SCRIPT.ts         ‚Üê generated by build
‚îÇ   __STRINGS.json      ‚Üê generated by build
‚îÇ
‚îú‚îÄ SDK/
‚îÇ   ‚îú‚îÄ mod/             ‚Üê official Battlefield Portal typings
‚îÇ   ‚îî‚îÄ modlib/
‚îÇ
‚îî‚îÄ src/
    ‚îú‚îÄ main.ts          ‚Üê entry point (creates game mode)
    ‚îú‚îÄ Core/
    ‚îÇ    ‚îî‚îÄ AGameMode.ts
    ‚îî‚îÄ GameModes/
         (your modes here)
```

All your gameplay code lives in `src/`.  
The framework flattens everything into `__SCRIPT.ts`.

---

# üöÄ Installation

```bash
npm install
```

This installs:

-   TypeScript
-   bf6-portal-mod-framework (build system)

---

# ‚öô Available Commands

### Build (merge + strings)

```bash
npm run build
```

Produces:

```
__SCRIPT.ts
__STRINGS.json
```

Paste `__SCRIPT.ts` into the Portal Web Editor.  
Upload `__STRINGS.json` into the Portal UI String Editor.

---

### Watch (merge only)

```bash
npm run watch
```

Regenerates `__SCRIPT.ts` whenever you save files.

> ‚ö† `__STRINGS.json` is **not** updated in watch mode.  
> Run `npm run build` when you modify string annotations.

---

### Update SDK

```bash
npm run update-sdk
```

Downloads the latest Portal SDK typings into `SDK/`.

---

# üéÆ How Your Mod Runs

`src/main.ts` is executed first.  
You instantiate your game mode there:

```ts
import { MyGameMode } from './GameModes/MyGameMode'

export const gameMode = new MyGameMode()
```

Everything else is normal TypeScript ‚Äî classes, interfaces, modules, nested files ‚Äî the framework will merge it into one script.

---

# üí¨ Strings System (via bf6-portal-mod-framework)

The template supports **static**, **dynamic**, and **annotation-based** strings.  
During build, the framework writes them all into:

```
__STRINGS.json
```

---

# 1Ô∏è‚É£ Static Strings

### Static Message

```ts
mod.Message('hello')
```

‚Üí produces `"hello": "hello"`

### Static With Parameters

```ts
mod.Message('static.messageWithParams', 1)
```

‚Üí `"static.messageWithParams": "static.messageWithParams {}"`

### Static StringKey

```ts
mod.stringkeys.static.stringkey
```

‚Üí `"static.stringkey": "static.stringkey"`

All static keys are always captured automatically.

---

# 2Ô∏è‚É£ Dynamic Strings

Dynamic keys use template literals:

```ts
mod.Message(`ai.bots.${i}`)
```

To expand them, you must _declare possible values_ using an annotation.

---

# 3Ô∏è‚É£ Annotations ‚Äî `@stringkeys`

Annotation format:

```ts
// @stringkeys <namespace>: <values>
```

Supported values:

-   numeric ranges (`0..3`)
-   alphabet ranges (`A..F`)
-   lists (`Idle, Roam, Fight`)
-   mixed (`Idle, A..C, 10..12`)

---

# üî• Full Real Example from Template

### Code (in your GameMode):

```ts
mod.Message(`test`)

mod.Message(`static.message`)
mod.Message(`static.messageWithParams`, 1)

mod.stringkeys.static.stringkey

// @stringkeys dynamic.range: 1..2
for (let i = 0; i < 4; i++) {
    mod.Message(`dynamic.range.${i}`)
}

// @stringkeys dynamic.list: Idle, Roam, Fight
const state = 'Idle'
mod.Message(`dynamic.list.${state}`)
```

### Generated Output (`__STRINGS.json`):

```json
{
    "dynamic": {
        "range": {
            "1": "dynamic.range.1",
            "2": "dynamic.range.2"
        },
        "list": {
            "Idle": "dynamic.list.Idle",
            "Roam": "dynamic.list.Roam",
            "Fight": "dynamic.list.Fight"
        }
    },
    "test": "test",
    "static": {
        "message": "static.message",
        "messageWithParams": "static.messageWithParams {}",
        "stringkey": "static.stringkey"
    }
}
```

Notes:

-   Only declared dynamic range values are included (`1`, `2`)
-   Loop values outside annotation (`0`, `3`) are ignored
-   Lists expand exactly as written
-   Static keys always work

---

# 4Ô∏è‚É£ Dynamic Key Rules

Dynamic keys must match:

```
namespace.part.${variable}
```

### Valid:

```ts
mod.Message(`dynamic.range.${i}`)
mod.Message(`ui.buttons.${btn}`)
```

### Invalid (ignored):

```ts
mod.Message(`ai.${type}.${i}`) // multiple dynamic parts
mod.Message(`${a}.${b}`) // namespace dynamic
mod.Message(`bots.${p}.${x}`) // dynamic too deep
```

---

# ‚ö† Optional: Warn About Removed Keys

Add to your `package.json`:

```json
{
    "bf6mod": {
        "warnUnusedStrings": true
    }
}
```

This prints warnings when a key existed in the old `__STRINGS.json` but was removed on rebuild.

---

# üß© Recommended Mod Layout

This template supports any folder structure:

```
src/
  Core/
  GameModes/
  AI/
  Utils/
  Weapons/
  UI/
```

The framework merges all of it into one battle-proven script.

---

# ü™Ñ Build Output

After running:

```
npm run build
```

You get:

-   `__SCRIPT.ts` ‚Üí paste into Portal Web Editor
-   `__STRINGS.json` ‚Üí upload to Portal UI

---

# üìú License

MIT